"use strict";(self.webpackChunkAnime=self.webpackChunkAnime||[]).push([[970],{1970:(A,d,n)=>{n.r(d),n.d(d,{SearchModule:()=>U});var c=n(6814),l=n(7472),t=n(4946),p=n(7398),m=n(9862);let h=(()=>{class s{constructor(){this.ids=[];const e=localStorage.getItem("favorites");e&&(this.ids=JSON.parse(e))}add(e){this.ids.some(i=>i==e)||(this.ids.push(e),this.saveChanges())}remove(e){this.ids.some(i=>i==e)&&(this.ids=this.ids.filter(i=>i!=e),this.saveChanges())}isAnimeFavorite(e){return this.ids.some(i=>i==e)}saveChanges(){localStorage.setItem("favorites",JSON.stringify(this.ids))}static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),u=(()=>{class s{constructor(e,i){this.http=e,this.favoriteService=i,this.baseUrl="https://api.jikan.moe/v4"}search(e){const i=e.replace(" ","%20");return this.http.get(`${this.baseUrl}/anime?q=${i}&sfw=true&page=1`).pipe((0,p.U)(a=>a&&a.data?a.data.map(r=>{const I=this.favoriteService.isAnimeFavorite(r.mal_id);return{mal_id:r.mal_id,title:r.title,synopsis:r.synopsis,image:r?.images?.jpg?.image_url,trailer:r?.trailer?.embed_url,year:r.year,type:r.type,is_favorite:I}}):[]))}getById(e){return this.http.get(`${this.baseUrl}/anime/${e}`).pipe((0,p.U)(i=>{const a=this.favoriteService.isAnimeFavorite(i.data.mal_id);return{mal_id:i.data.mal_id,title:i.data.title,synopsis:i.data.synopsis,image:i.data?.images?.jpg?.image_url,trailer:i.data?.trailer?.embed_url,year:i.data.year,type:i.data.type,is_favorite:a}}))}static#t=this.\u0275fac=function(i){return new(i||s)(t.LFG(m.eN),t.LFG(h))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();const f=["searchInput"];function v(s,o){1&s&&(t.TgZ(0,"div")(1,"span",16),t.O4$(),t.TgZ(2,"svg",17),t._UZ(3,"path",18),t.qZA()()())}function g(s,o){if(1&s&&(t.TgZ(0,"div",8)(1,"a",9)(2,"div",10),t.YNc(3,v,4,0,"div",5),t._UZ(4,"img",11),t.TgZ(5,"div",12)(6,"span",13),t._uU(7),t.qZA(),t.TgZ(8,"span",14),t._uU(9),t.qZA(),t.TgZ(10,"p",15),t._uU(11),t.qZA()()()()()),2&s){const e=o.$implicit;t.xp6(1),t.MGl("routerLink","detail/",e.mal_id,""),t.xp6(2),t.Q6J("ngIf",e.is_favorite),t.xp6(1),t.Q6J("src",e.image,t.LSH)("alt",e.title),t.xp6(3),t.Oqu(e.type),t.xp6(2),t.Oqu(e.year),t.xp6(2),t.Oqu(e.title)}}function _(s,o){if(1&s&&(t.TgZ(0,"div")(1,"div",6),t.YNc(2,g,12,7,"div",7),t.qZA()()),2&s){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.results)}}function y(s,o){1&s&&(t.TgZ(0,"div")(1,"h5",19),t._uU(2,"Por favor de iniciar realizando una busqueda..."),t.qZA()())}let x=(()=>{class s{constructor(e,i){this.searchService=e,this.favoriteService=i,this.results=[]}ngOnInit(){const e=localStorage.getItem("lastSearch");e&&(this.results=JSON.parse(e),this.results=this.results.map(i=>{const a=this.favoriteService.isAnimeFavorite(i.mal_id);return{...i,is_favorite:a}}))}search(){this.searchService.search(this.searchInput.nativeElement.value).subscribe(i=>{this.results=i,localStorage.setItem("lastSearch",JSON.stringify(this.results))})}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(u),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-search-page"]],viewQuery:function(i,a){if(1&i&&t.Gf(f,5),2&i){let r;t.iGM(r=t.CRH())&&(a.searchInput=r.first)}},decls:8,vars:2,consts:[[1,"d-flex","justify-content-end"],["id","searchPanel",1,"d-flex"],["type","text","id","name","placeholder","Nombre",1,"form-control","mx-2"],["searchInput",""],[1,"btn","btn-outline-primary",3,"click"],[4,"ngIf"],[1,"row","pt-2"],["class","col-6 col-md-4 col-lg-3 py-3",4,"ngFor","ngForOf"],[1,"col-6","col-md-4","col-lg-3","py-3"],[2,"cursor","pointer",3,"routerLink"],[1,"card","position-relative",2,"width","15rem"],[1,"img-fluid","card-img-top",2,"max-height","20rem",3,"src","alt"],[1,"card-body"],[1,"badge","text-bg-secondary","me-2"],[1,"badge","text-bg-info"],[1,"card-text","title"],[1,"position-absolute","top-0","start-100","translate-middle","p-2","bg-light","border-light","rounded-circle"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-heart",2,"color","red"],["d","m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"],[1,"h5"]],template:function(i,a){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"input",2,3),t.TgZ(4,"button",4),t.NdJ("click",function(){return a.search()}),t._uU(5,"Buscar"),t.qZA()()(),t.YNc(6,_,3,1,"div",5),t.YNc(7,y,3,0,"div",5)),2&i&&(t.xp6(6),t.Q6J("ngIf",a.results&&a.results.length>0),t.xp6(1),t.Q6J("ngIf",!a.results||0==a.results.length))},dependencies:[c.sg,c.O5,l.rH],styles:[".img[_ngcontent-%COMP%]{width:100px}.title[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return s})();var S=n(6593);function Z(s,o){if(1&s&&(t.TgZ(0,"div",1),t._UZ(1,"iframe",10),t.qZA()),2&s){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.secureUrl,t.uOi)}}const C=function(s,o){return{"btn-outline-success":s,"btn-success":o}};function b(s,o){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"h2",2),t._uU(3),t.qZA()(),t._UZ(4,"hr",3),t.TgZ(5,"div",1)(6,"div",4)(7,"div",5),t._UZ(8,"img",6),t.TgZ(9,"button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.toggleFavorites())}),t._uU(10),t.qZA()()(),t.TgZ(11,"div",8),t._uU(12),t.qZA()(),t._UZ(13,"hr",3),t.YNc(14,Z,2,1,"div",9),t.qZA()}if(2&s){const e=t.oxw();t.xp6(3),t.hij(" ",e.anime.title,""),t.xp6(5),t.Q6J("src",e.anime.image,t.LSH),t.xp6(1),t.Q6J("ngClass",t.WLB(6,C,!e.anime.is_favorite,e.anime.is_favorite)),t.xp6(1),t.hij("",e.anime.is_favorite?"Remover de":"Agregar a"," favoritos"),t.xp6(2),t.hij(" ",e.anime.synopsis," "),t.xp6(2),t.Q6J("ngIf",e.secureUrl)}}const w=[{path:"",component:x},{path:"detail/:id",component:(()=>{class s{constructor(e,i,a,r){this.searchService=e,this.sanitizer=i,this.route=a,this.favoriteService=r}ngOnInit(){const e=this.route.snapshot.paramMap.get("id");e&&this.searchService.getById(+e).subscribe(i=>{this.anime=i,this.sanitizeUrl(i.trailer)})}sanitizeUrl(e){e&&(this.secureUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e))}toggleFavorites(){this.anime&&(this.anime.is_favorite=!this.anime.is_favorite,this.anime.is_favorite?this.favoriteService.add(this.anime.mal_id):this.favoriteService.remove(this.anime.mal_id))}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(u),t.Y36(S.H7),t.Y36(l.gz),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-detail"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"h2"],[1,"hr"],[1,"col-4"],[1,"d-flex","flex-column",2,"max-width","35vh"],[1,"img-thumbnail",3,"src"],[1,"btn",3,"ngClass","click"],[1,"col-8","text-wrap"],["class","row",4,"ngIf"],["width","560","height","315","frameborder","0","allowfullscreen","",3,"src"]],template:function(i,a){1&i&&t.YNc(0,b,15,9,"div",0),2&i&&t.Q6J("ngIf",a.anime)},dependencies:[c.mk,c.O5]})}return s})()}];let T=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#i=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(w),l.Bz]})}return s})(),U=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#i=this.\u0275inj=t.cJS({imports:[c.ez,T]})}return s})()}}]);